<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>JackyWang&#39;s Hexo Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="JackyWang&#39;s Hexo Blog">
<meta property="og:url" content="http://192.168.1.3/index.html">
<meta property="og:site_name" content="JackyWang&#39;s Hexo Blog">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JackyWang&#39;s Hexo Blog">
  
    <link rel="alternate" href="/atom.xml" title="JackyWang&#39;s Hexo Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">JackyWang&#39;s Hexo Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">telecommunication semiconductor development</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://192.168.1.3"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/06/25/hello-world/" class="article-date">
  <time datetime="2017-06-25T08:54:27.571Z" itemprop="datePublished">2017-06-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/06/25/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://192.168.1.3/2017/06/25/hello-world/" data-id="cj4e773ft0004okxtyqc4oizn" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-linux-daemon" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/06/25/linux-daemon/" class="article-date">
  <time datetime="2017-06-25T08:01:28.000Z" itemprop="datePublished">2017-06-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/06/25/linux-daemon/">linux-daemon</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-gt-How-to-list-all-running-daemons"><a href="#1-gt-How-to-list-all-running-daemons" class="headerlink" title="1&gt; How to list all running daemons?"></a>1&gt; How to list all running daemons?</h2><h3 id="1-1-gt-resolution"><a href="#1-1-gt-resolution" class="headerlink" title="1.1&gt; resolution"></a>1.1&gt; resolution</h3><p>a daemon is a process running without a controlling terminal attached.</p>
<h3 id="1-2-gt-answer1-for-an-embedded-system-without-GUI"><a href="#1-2-gt-answer1-for-an-embedded-system-without-GUI" class="headerlink" title="1.2&gt; answer1 for an embedded system without GUI"></a>1.2&gt; answer1 for an embedded system without GUI</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ps -eo <span class="string">'tty,pid,comm'</span> | grep ^?</div></pre></td></tr></table></figure>
<h3 id="1-3-gt-answer2-for-a-standard-system-that-root-doesn’t-run-graphical-programs"><a href="#1-3-gt-answer2-for-a-standard-system-that-root-doesn’t-run-graphical-programs" class="headerlink" title="1.3&gt; answer2, for a standard system that root doesn’t run graphical programs"></a>1.3&gt; answer2, for a standard system that root doesn’t run graphical programs</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ps -U0 -o <span class="string">'tty,pid,comm'</span> | grep ^? <span class="comment"># exclude daemons without root privileges</span></div></pre></td></tr></table></figure>
<h3 id="1-4-gt-answer3"><a href="#1-4-gt-answer3" class="headerlink" title="1.4&gt; answer3"></a>1.4&gt; answer3</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ps -C <span class="string">"<span class="variable">$(xlsclients | cut -d' ' -f3 | paste - -s -d ',')</span>"</span> --ppid 2 --pid 2 --deselect -o tty,args | grep ^?</div></pre></td></tr></table></figure>
<p>Then, what does it mean?<br>1.4.1&gt; list all GUI programs for which we have running processes<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ xlsclients | cut -d<span class="string">' '</span> -f3 | paste - -s -d <span class="string">','</span></div></pre></td></tr></table></figure></p>
<p>1.4.2&gt; show all processes which their name aren’t in the above list<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ps -C <span class="string">"<span class="variable">$(xlsclients | cut -d' ' -f3 | paste - -s -d ',')</span>"</span> --deselect</div></pre></td></tr></table></figure></p>
<p>1.4.3&gt; non-GUI and “no TTY attached”<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ps -C <span class="string">"<span class="variable">$(xlsclients | cut -d' ' -f3 | paste - -s -d ',')</span>"</span> --deselect -o tty,args | grep ^?</div></pre></td></tr></table></figure></p>
<p>1.4.4&gt; at last, exclude kernel threads(which aren’t processes)<br>$ ps –ppid 2 –pid 2 –deselect</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://192.168.1.3/2017/06/25/linux-daemon/" data-id="cj4e773fv0005okxt6p96qn9h" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-gerrit-mngt" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/06/25/gerrit-mngt/" class="article-date">
  <time datetime="2017-06-25T03:22:28.000Z" itemprop="datePublished">2017-06-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/06/25/gerrit-mngt/">Gerrit mangement</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-gt-maintain-gerrit-as-an-‘admin’"><a href="#1-gt-maintain-gerrit-as-an-‘admin’" class="headerlink" title="1&gt; maintain gerrit as an ‘admin’"></a>1&gt; maintain gerrit as an ‘admin’</h2><h3 id="1-1-gt-auth"><a href="#1-1-gt-auth" class="headerlink" title="1.1&gt; auth"></a>1.1&gt; auth</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ ssh-keygen -t rsa -C <span class="string">"管理员"</span> -f ~/.ssh/gerrit_admin</div><div class="line">$ cat ~/.ssh/gerrit_admin.pub</div><div class="line">  <span class="comment"># copy the public key</span></div></pre></td></tr></table></figure>
<p>Visit your <a href="http://192.168.1.3:8080">localgerrit</a> webpage, click “Anonymous Coward (1000000)”-&gt;”Settings”-&gt;”SSH Public Keys”, paste the above public key, then click “Add Key”.</p>
<h3 id="1-2-gt-verify-the-connection"><a href="#1-2-gt-verify-the-connection" class="headerlink" title="1.2&gt; verify the connection"></a>1.2&gt; verify the connection</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ ssh -p 29418 -i ~/.ssh/gerrit_admin 192.168.1.3 -l admin</div><div class="line">  ****    Welcome to Gerrit Code Review    ****</div><div class="line">  Hi admin, you have successfully connected over SSH.</div><div class="line">  Unfortunately, interactive shells are disabled.</div><div class="line">  To <span class="built_in">clone</span> a hosted Git repository, use:</div><div class="line">  git <span class="built_in">clone</span> ssh://admin@192.168.1.3:29418/REPOSITORY_NAME.git</div><div class="line">  Connection to 192.168.1.101 closed</div></pre></td></tr></table></figure>
<p>If console output is same as the above, all is set! Otherwise, execute the below and then try again.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ rm -rf ~/.ssh/known_hosts</div></pre></td></tr></table></figure></p>
<h3 id="1-3-gt-create-one-alias-for-this-connection"><a href="#1-3-gt-create-one-alias-for-this-connection" class="headerlink" title="1.3&gt; create one alias for this connection"></a>1.3&gt; create one alias for this connection</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ vi ~/.ssh/config</div><div class="line">Host lgadmin</div><div class="line">    HostName 192.168.1.3</div><div class="line">    User admin</div><div class="line">    Port 29418</div><div class="line">    IdentityFile ~/.ssh/gerrit_admin</div></pre></td></tr></table></figure>
<h3 id="1-4-gt-Verify-your-alias"><a href="#1-4-gt-Verify-your-alias" class="headerlink" title="1.4&gt; Verify your alias"></a>1.4&gt; Verify your alias</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ ssh lgadmin</div><div class="line">  ****    Welcome to Gerrit Code Review    ****</div><div class="line">  Hi admin, you have successfully connected over SSH.</div><div class="line">  Unfortunately, interactive shells are disabled.</div><div class="line">  To <span class="built_in">clone</span> a hosted Git repository, use:</div><div class="line">  git <span class="built_in">clone</span> ssh://admin@192.168.1.3:29418/REPOSITORY_NAME.git</div><div class="line">  Connection to 192.168.1.3 closed</div></pre></td></tr></table></figure>
<p>The console output should be same as using 1.2&gt;</p>
<h2 id="2-gt-management-the-database"><a href="#2-gt-management-the-database" class="headerlink" title="2&gt; management the database"></a>2&gt; management the database</h2><h3 id="2-1-gt-login-the-database"><a href="#2-1-gt-login-the-database" class="headerlink" title="2.1&gt; login the database"></a>2.1&gt; login the database</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ ssh lgadmin gerrit gsql</div><div class="line">fatal: admin does not have <span class="string">"Access Database"</span> capability.</div></pre></td></tr></table></figure>
<p>Fix for the version later than 2.12: It only can be fixed by enable database access through the WebUI!<br>login <a href="http://192.168.1.3:8080">localgerrit</a>, click “Project”-&gt;”All-Projects”-&gt;”Edit”-&gt;”Global Capabilities”-&gt;”add permission”<br>Fix for the version like 2.0:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ vi /etc/gerrit/git/All-Projects/refs/meta/config/project.config</div><div class="line">[capability]</div><div class="line">       accessDatabase = group Administrators</div></pre></td></tr></table></figure></p>
<h2 id="3-gt-manage-groups"><a href="#3-gt-manage-groups" class="headerlink" title="3&gt; manage groups"></a>3&gt; manage groups</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ssh lgadmin gerrit ls-groups</div></pre></td></tr></table></figure>
<h2 id="4-gt-manage-projects"><a href="#4-gt-manage-projects" class="headerlink" title="4&gt; manage projects"></a>4&gt; manage projects</h2><h3 id="4-1-gt-create-one-new-project"><a href="#4-1-gt-create-one-new-project" class="headerlink" title="4.1&gt; create one new project"></a>4.1&gt; create one new project</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ssh lgadmin gerrit create-project <span class="string">"test/helloworld"</span> --description <span class="string">"'Tools used by build system'"</span> --owner <span class="string">"user/admin"</span> --parent <span class="string">"All-Projects"</span></div></pre></td></tr></table></figure>
<h3 id="4-2-gt-modify-configurations-for-one-project"><a href="#4-2-gt-modify-configurations-for-one-project" class="headerlink" title="4.2&gt; modify configurations for one project"></a>4.2&gt; modify configurations for one project</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ssh lgadmin gerrit <span class="built_in">set</span>-project <span class="string">"repo_name"</span> --project-state ACTIVE --submit-type FAST_FORWARD_ONLY</div></pre></td></tr></table></figure>
<h3 id="4-3-gt-设置继承项目"><a href="#4-3-gt-设置继承项目" class="headerlink" title="4.3&gt; 设置继承项目"></a>4.3&gt; 设置继承项目</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ssh lgadmin gerrit <span class="built_in">set</span>-project-parent <span class="string">"repo_name"</span> --parent <span class="string">"parent_repo"</span></div></pre></td></tr></table></figure>
<h3 id="4-4-gt-自动审查打分"><a href="#4-4-gt-自动审查打分" class="headerlink" title="4.4&gt; 自动审查打分"></a>4.4&gt; 自动审查打分</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ ssh lgadmin gerrit review &#123;COMMITID | CHANGEID,PATCHSET&#125; --verified +1 --code-review +1 --message <span class="string">"review from ssh"</span></div><div class="line">$ cat ~/.ssh/user1.pub | ssh ha gerrit create-account --email user1@163.com --full-name 张三 --ssh-key</div></pre></td></tr></table></figure>
<h3 id="4-5-gt-修改默认的项目权限"><a href="#4-5-gt-修改默认的项目权限" class="headerlink" title="4.5&gt; 修改默认的项目权限"></a>4.5&gt; 修改默认的项目权限</h3><p>默认: 项目的master分支只有administrators和Project Owners可以不经代码审核直接推送,但允许其他用户向master分支推送changes接受评审.<br>期望: Registered Users组用户不能向master推送changes,而只能向devel分支推送changes。devel分支的权限默认即可。项目只有两个常设分支master和devel,日常开发只在devel分支上,只有管理员才能touch master分支.<br>修改设置: Project-&gt;list(选定项目)-&gt;Access-&gt;Edit-&gt;Add Reference, reference的名字为:refs/for/refs/heads/master,然后添加push权限,添加组”Registered Users”,选择对应的push权限为deny,同时勾选Exclusive，覆盖掉该ref继承和被通配符所涵盖的权限.</p>
<h3 id="4-6-gt-修改Code-Review和submit的权限"><a href="#4-6-gt-修改Code-Review和submit的权限" class="headerlink" title="4.6&gt; 修改Code Review和submit的权限"></a>4.6&gt; 修改Code Review和submit的权限</h3><p>默认: 只给Registered Users组用户Code View -1分到1分的权限,这样Registered Users组用户就无法独立完成代码审核, 而且该组用户没有submit的权限,无法合并补丁到仓库中.<br>期望: 因为developer都集中在Registered Users中,包括资深的developer,所以Code View权限需要提高.同时需要添加submit权限.<br>修改设置: Project-&gt;list(选定项目)-&gt;Access-&gt;Edit-&gt;Add Reference,reference的名字为:refs/heads/*,然后添加Label Code-Review,添加组”Registered Users”,将其权限调整为-2~2.然后对Submit权限添加组”Registered Users”并设为ALLOW.</p>
<h3 id="4-7-gt-允许个人创建和维护sandbox分支"><a href="#4-7-gt-允许个人创建和维护sandbox分支" class="headerlink" title="4.7&gt; 允许个人创建和维护sandbox分支"></a>4.7&gt; 允许个人创建和维护sandbox分支</h3><p>即个人分支,是十分有必要的,在开发成果还没有达到可以参加评审之前,用户可以在个人分支暂存自己的代码<br>修改设置: 添加引用refs/heads/sandbox/${username}/*,选择权限Create Reference和push,”Registered Users”组权限皆为ALLOW</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://192.168.1.3/2017/06/25/gerrit-mngt/" data-id="cj4e773fe0001okxtxxpbtmjl" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-gerrit-tutor" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/06/25/gerrit-tutor/" class="article-date">
  <time datetime="2017-06-25T03:22:28.000Z" itemprop="datePublished">2017-06-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/06/25/gerrit-tutor/">Gerrit tutorial</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-gt-Setup-a-git-server"><a href="#1-gt-Setup-a-git-server" class="headerlink" title="1&gt; Setup a git server"></a>1&gt; Setup a git server</h2><h3 id="1-1-gt-download-and-install"><a href="#1-1-gt-download-and-install" class="headerlink" title="1.1&gt; download and install"></a>1.1&gt; download and install</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ $ sudo apt-get install git</div></pre></td></tr></table></figure>
<h3 id="1-2-gt-create-one-user-to-be-dedicated-for-git-service"><a href="#1-2-gt-create-one-user-to-be-dedicated-for-git-service" class="headerlink" title="1.2&gt; create one user to be dedicated for git service"></a>1.2&gt; create one user to be dedicated for git service</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ $ sudo adduser git</div></pre></td></tr></table></figure>
<h3 id="1-3-gt-import-users’-rsa-public-key-to-‘authorized-keys’"><a href="#1-3-gt-import-users’-rsa-public-key-to-‘authorized-keys’" class="headerlink" title="1.3&gt; import users’ rsa_public_key to ‘authorized_keys’"></a>1.3&gt; import users’ rsa_public_key to ‘authorized_keys’</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ su git</div><div class="line">$ <span class="built_in">cd</span> ~ <span class="comment"># /home/git</span></div><div class="line">$ mkdir .ssh</div><div class="line">$ <span class="built_in">cd</span> .ssh</div><div class="line">$ touch authorized_keys</div></pre></td></tr></table></figure>
<p>Notice: one ssh session (pair of server&amp;client) produce one ‘id_rsa.pub’.if the port number for one ssh session is changed, the key will change.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">user@user_PC:~$ ssh-keygen -t rsa -C <span class="string">'account_name'</span></div></pre></td></tr></table></figure></p>
<p>try any way to copy file ‘id_rsa.pub’ to the server’s PC, then<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ cat id_rsa.pub &gt;&gt; authorized_keys</div><div class="line">$ chmod 600 authorized_keys</div></pre></td></tr></table></figure></p>
<h3 id="1-4-gt-create-a-dedicated-folder-to-save-all-repositories"><a href="#1-4-gt-create-a-dedicated-folder-to-save-all-repositories" class="headerlink" title="1.4&gt; create a dedicated folder to save all repositories"></a>1.4&gt; create a dedicated folder to save all repositories</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">cd</span> ~</div><div class="line">$ git init --bare sample.git <span class="comment"># '--bare' means no 'work area'</span></div><div class="line">``` bash</div><div class="line"><span class="comment">#5&gt; forbidden user 'git' to login with the shell</span></div><div class="line">``` bash</div><div class="line">$ <span class="built_in">exit</span></div><div class="line">$ $ sudo vi /etc/passwd</div></pre></td></tr></table></figure>
<p>change “git:x:1001:1001:,,,:/home/git:/bin/bash”<br>  into “git:x:1001:1001:,,,:/home/git:/usr/bin/git-shell”</p>
<h2 id="2-gt-install-‘jre’-as-a-must"><a href="#2-gt-install-‘jre’-as-a-must" class="headerlink" title="2&gt; install ‘jre’ as a must"></a>2&gt; install ‘jre’ as a must</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo apt-get install default-jre</div></pre></td></tr></table></figure>
<h2 id="3-gt-install-and-config-‘mysql’-if-MYSQL-‘Database-server’-is-to-be-used"><a href="#3-gt-install-and-config-‘mysql’-if-MYSQL-‘Database-server’-is-to-be-used" class="headerlink" title="3&gt; install and config ‘mysql’ if MYSQL ‘Database server’ is to be used"></a>3&gt; install and config ‘mysql’ if MYSQL ‘Database server’ is to be used</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ sudo apt-get install mysql-server <span class="comment"># mysql-client libmysqlclient-dev</span></div><div class="line">$ sudo netstat -tap | grep mysql</div><div class="line">$ sudo mysql -u root -p &gt; create database gerritdb; &gt; grant all on gerritdb.* to <span class="string">'gerrituser'</span>@<span class="string">'localhost'</span> identified by <span class="string">'gerritpass'</span>;</div></pre></td></tr></table></figure>
<h2 id="4-gt-install-and-config-‘gerrit’-server"><a href="#4-gt-install-and-config-‘gerrit’-server" class="headerlink" title="4&gt; install and config ‘gerrit’ server"></a>4&gt; install and config ‘gerrit’ server</h2><h3 id="4-1-gt-download-the-latest-gerrit-package"><a href="#4-1-gt-download-the-latest-gerrit-package" class="headerlink" title="4.1&gt; download the latest gerrit package"></a>4.1&gt; download the latest gerrit package</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">wget http://gerrit-releases.storage.googleapis.com/gerrit-2.9.war</div><div class="line">wget http://www.bouncycastle.org/download/bcpkix-jdk15on-149.jar</div><div class="line">wget http://www.bouncycastle.org/download/bcprov-jdk15on-149.jar</div></pre></td></tr></table></figure>
<h3 id="4-2-gt-install-gerrit-to-a-specified-folder"><a href="#4-2-gt-install-gerrit-to-a-specified-folder" class="headerlink" title="4.2&gt; install gerrit to a specified folder"></a>4.2&gt; install gerrit to a specified folder</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ sudo mkdir /etc/gerrit</div><div class="line">$ sudo java -jar gerrit-2.9.war init -d /etc/gerrit</div></pre></td></tr></table></figure>
<p>press ‘enter’ directly except the following 2 changes<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">*** User Authentication</div><div class="line">Authentication method          [OPENID/?]: http</div><div class="line">*** HTTP Daemon</div><div class="line">Behind reverse proxy           [y/N]? y</div></pre></td></tr></table></figure></p>
<p>At last, the install process start the ‘gerrit’ thread, press ‘Ctrl+C’ to abort webpage addressing<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ sudo cp bcpkix-jdk15on-149.jar /etc/gerrit/lib/</div><div class="line">$ sudo cp bcprov-jdk15on-149.jar /etc/gerrit/lib/</div></pre></td></tr></table></figure></p>
<h3 id="4-3-gt-confirm-the-port-number-which-your-specified"><a href="#4-3-gt-confirm-the-port-number-which-your-specified" class="headerlink" title="4.3&gt; confirm the port number which your specified"></a>4.3&gt; confirm the port number which your specified</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ sudo netstat -lnp | grep Gerrit</div><div class="line">tcp6       0      0 :::29418        :::*          LISTEN      7370/GerritCodeRevi</div><div class="line">tcp6       0      0 127.0.0.1:8081  :::*          LISTEN      7370/GerritCodeRevi</div></pre></td></tr></table></figure>
<p>CONFIRM: configure gerrit per your requrements<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">$ sudo vi /etc/gerrit/etc/gerrit.config</div><div class="line">[gerrit]</div><div class="line">	basePath = /home/git</div><div class="line">	<span class="comment"># replace the following with http://YourServerIP:GerritPort</span></div><div class="line">	canonicalWebUrl = http://192.168.1.3:8080</div><div class="line">[database]</div><div class="line">	<span class="built_in">type</span> = h2</div><div class="line">	database = db/ReviewDB</div><div class="line">[index]</div><div class="line">	<span class="built_in">type</span> = LUCENE</div><div class="line">[auth]</div><div class="line">	<span class="comment"># not the default/OPENID</span></div><div class="line">	<span class="built_in">type</span> = HTTP</div><div class="line">	<span class="comment"># a fix for logout, to be verified</span></div><div class="line">	logoutUrl = http://aa:aa@10.10.68.224</div><div class="line">[sendemail]</div><div class="line">	smtpServer = smtp.sina.com</div><div class="line">	smtpUser = kenwj</div><div class="line">[container]</div><div class="line">	user = root</div><div class="line">	javaHome = /usr/lib/jvm/java-7-openjdk-i386/jre</div><div class="line">[sshd]</div><div class="line">	listenAddress = *:29418</div><div class="line">[httpd]</div><div class="line">	<span class="comment"># corresponding to apache2-&gt;gerrit.conf-&gt;ProxyPass</span></div><div class="line">	listenUrl = proxy-http://127.0.0.1:8081/</div><div class="line">[cache]</div><div class="line">	directory = cache</div></pre></td></tr></table></figure></p>
<h3 id="4-4-gt-restart-“gerrit”-as-the-config-has-changed"><a href="#4-4-gt-restart-“gerrit”-as-the-config-has-changed" class="headerlink" title="4.4&gt; restart “gerrit” as the config has changed"></a>4.4&gt; restart “gerrit” as the config has changed</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo /etc/gerrit/bin/gerrit.sh restart</div></pre></td></tr></table></figure>
<h3 id="4-5-gt-add-‘gerrit’-as-a-daemon-auto-start-service"><a href="#4-5-gt-add-‘gerrit’-as-a-daemon-auto-start-service" class="headerlink" title="4.5&gt; add ‘gerrit’ as a daemon/auto-start service"></a>4.5&gt; add ‘gerrit’ as a daemon/auto-start service</h3><p>NOTICE: add “GERRIT_SITE=/etc/gerrit” in “/etc/gerrit/bin/gerrit.sh” at first<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ sudo <span class="built_in">echo</span> <span class="string">"GERRIT_SITE=/etc/gerrit"</span> &gt;&gt; /etc/gerrit/bin/gerrit.sh</div><div class="line">$ sudo cp /etc/gerrit/bin/gerrit.sh /etc/init.d/gerrit</div><div class="line">$ sudo update-rc.d gerrit defaults 21</div><div class="line">$ sudo service gerrit restart</div></pre></td></tr></table></figure></p>
<p>CONFIRM: restart your PC, after boot up, check whether ‘gerrit’ is up or not<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ service gerrit status</div></pre></td></tr></table></figure></p>
<h2 id="5-gt-install-and-config-‘apache2’-for-gerrit-http-proxy"><a href="#5-gt-install-and-config-‘apache2’-for-gerrit-http-proxy" class="headerlink" title="5&gt; install and config ‘apache2’ for gerrit http proxy"></a>5&gt; install and config ‘apache2’ for gerrit http proxy</h2><h3 id="5-1-gt-install-‘apache2’-as-a-http-server"><a href="#5-1-gt-install-‘apache2’-as-a-http-server" class="headerlink" title="5.1&gt; install ‘apache2’ as a http server"></a>5.1&gt; install ‘apache2’ as a http server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo apt-get install apache2 apache2-utils</div></pre></td></tr></table></figure>
<p>NOTICE: then the latest version will be installed automaticly, configurations to do may be different per specific version.<br>HELP: check the version info<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ /usr/sbin/apache2 -v</div><div class="line">Server version: Apache/2.4.7 (Ubuntu)</div><div class="line">Server built:   May  9 2017 16:13:38</div></pre></td></tr></table></figure></p>
<h3 id="5-2-gt-create-a-file-to-save-users’-passwd-for-your-gerrit-site"><a href="#5-2-gt-create-a-file-to-save-users’-passwd-for-your-gerrit-site" class="headerlink" title="5.2&gt; create a file to save users’ passwd for your gerrit site"></a>5.2&gt; create a file to save users’ passwd for your gerrit site</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ sudo touch /etc/apache2/htpasswd_gerrit</div><div class="line">$ sudo htpasswd -b /etc/apache2/htpasswd_gerrit admin admin</div></pre></td></tr></table></figure>
<h3 id="5-3-gt-read-the-global-config-file-and-understand-the-structure"><a href="#5-3-gt-read-the-global-config-file-and-understand-the-structure" class="headerlink" title="5.3&gt; read the global config file and understand the structure"></a>5.3&gt; read the global config file and understand the structure</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo vi /etc/apache2/apache2.conf</div></pre></td></tr></table></figure>
<h3 id="5-4-gt-add-the-http-port-number-for-your-gerrit"><a href="#5-4-gt-add-the-http-port-number-for-your-gerrit" class="headerlink" title="5.4&gt; add the http port number for your gerrit"></a>5.4&gt; add the http port number for your gerrit</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">echo</span> <span class="string">"Listen 8080"</span> &gt;&gt; /etc/apache2/ports.conf</div></pre></td></tr></table></figure>
<h3 id="5-5-gt-create-a-config-for-your-gerrit-site-similar-to-the-following"><a href="#5-5-gt-create-a-config-for-your-gerrit-site-similar-to-the-following" class="headerlink" title="5.5&gt; create a config for your gerrit site, similar to the following"></a>5.5&gt; create a config for your gerrit site, similar to the following</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">$ sudo vi /etc/apache2/sites-enabled/gerrit.conf</div><div class="line">&lt;VirtualHost 192.168.1.3:8080&gt; <span class="comment"># the input to this http server</span></div><div class="line">    ServerName Jacky_Gerrit</div><div class="line">    ProxyRequests Off</div><div class="line">    ProxyVia Off</div><div class="line">    ProxyPreserveHost On</div><div class="line"></div><div class="line">    &lt;Proxy *&gt;</div><div class="line">          Order deny,allow</div><div class="line">          Allow from all</div><div class="line">    &lt;/Proxy&gt;</div><div class="line"></div><div class="line">    &lt;Location /login/&gt; <span class="comment"># the first page</span></div><div class="line">      AuthType Basic</div><div class="line">      AuthName <span class="string">"Gerrit Code Review"</span></div><div class="line">      Require valid-user</div><div class="line">      AuthBasicProvider file</div><div class="line">      AuthUserFile /etc/apache2/htpasswd_gerrit <span class="comment"># which you just specified</span></div><div class="line">    &lt;/Location&gt;</div><div class="line"></div><div class="line">    AllowEncodedSlashes On</div><div class="line">    ProxyPass / http://127.0.0.1:8081/ <span class="comment"># the output from this http server </span></div><div class="line">&lt;/VirtualHost&gt;</div></pre></td></tr></table></figure>
<p>It means that, if a user/client input <a href="http://192.168.1.3:8080">http://192.168.1.3:8080</a> on his webpage, the server(192.168.1.3) will address 127.0.0.1:8081 as a proxy.</p>
<h3 id="5-6-gt-restart-‘apache2’-daemon-as-the-config-has-changed"><a href="#5-6-gt-restart-‘apache2’-daemon-as-the-config-has-changed" class="headerlink" title="5.6&gt; restart ‘apache2’ daemon as the config has changed"></a>5.6&gt; restart ‘apache2’ daemon as the config has changed</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo /etc/init.d/apache2 restart</div></pre></td></tr></table></figure>
<p>HELP: if apache2 cannot start, read ‘/var/log/apache2/error.log’</p>
<h3 id="5-7-gt-possible-errors-when-using-lower-version"><a href="#5-7-gt-possible-errors-when-using-lower-version" class="headerlink" title="5.7&gt; possible errors when using lower version"></a>5.7&gt; possible errors when using lower version</h3><p>5.7.1&gt; issue: Syntax error /etc/apache2/apache2.conf:Invalid command ‘ProxyPass’ …<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ sudo <span class="built_in">cd</span> /etc/apache2/mods-enabled</div><div class="line">$ sudo ln -s /etc/apache2/mods-available/proxy.conf</div><div class="line">$ sudo ln -s /etc/apache2/mods-available/proxy.load</div><div class="line">$ sudo ln -s /etc/apache2/mods-available/proxy_http.load</div></pre></td></tr></table></figure></p>
<p>5.7.2&gt; issue: No apache MPM package installed<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo apt-get install apache2-mpm-worker</div></pre></td></tr></table></figure></p>
<p>5.7.3&gt; issue: apache2: Could not reliably determine the server’s fully qualified domain name<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">echo</span> <span class="string">"ServerName localhost"</span> &gt;&gt; /etc/apache2/x.conf</div></pre></td></tr></table></figure></p>
<p>5.7.4&gt; issue: apache2: Invalid command ‘ProxyRequests’<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo a2enmod proxy</div></pre></td></tr></table></figure></p>
<h1 id="—-maintain-gerrit-as-an-‘admin’"><a href="#—-maintain-gerrit-as-an-‘admin’" class="headerlink" title="—- maintain gerrit as an ‘admin’"></a>—- maintain gerrit as an ‘admin’</h1><h1 id="auth"><a href="#auth" class="headerlink" title="auth"></a>auth</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ ssh-keygen -t rsa -C <span class="string">"管理员"</span> -f ~/.ssh/gerrit_admin</div><div class="line">$ cat ~/.ssh/gerrit_admin.pub</div><div class="line">webpage: <span class="string">"Anonymous Coward (1000000)"</span>, <span class="string">'Settings'</span>, <span class="string">"SSH Public Keys"</span>, Add Key</div><div class="line">$ ssh -p 29418 -i ~/.ssh/gerrit_admin 192.168.1.3 -l admin</div></pre></td></tr></table></figure>
<h1 id="all-is-set-if-the-following-occurs"><a href="#all-is-set-if-the-following-occurs" class="headerlink" title="all is set if the following occurs"></a>all is set if the following occurs</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">****    Welcome to Gerrit Code Review    ****</div><div class="line">Hi admin, you have successfully connected over SSH.</div><div class="line">Unfortunately, interactive shells are disabled.</div><div class="line">To <span class="built_in">clone</span> a hosted Git repository, use:</div><div class="line">git <span class="built_in">clone</span> ssh://admin@192.168.1.3:29418/REPOSITORY_NAME.git</div><div class="line">Connection to 192.168.1.101 closed</div></pre></td></tr></table></figure>
<h1 id="otherwise-“rm-rf-ssh-known-hosts”-then-try-again"><a href="#otherwise-“rm-rf-ssh-known-hosts”-then-try-again" class="headerlink" title="otherwise, “rm -rf ~/.ssh/known_hosts” then try again"></a>otherwise, “rm -rf ~/.ssh/known_hosts” then try again</h1><h1 id="create-one-alias-for-this-connection"><a href="#create-one-alias-for-this-connection" class="headerlink" title="create one alias for this connection"></a>create one alias for this connection</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ vi ~/.ssh/config</div><div class="line">Host lgadmin</div><div class="line">    HostName 192.168.1.3</div><div class="line">    User admin</div><div class="line">    Port 29418</div><div class="line">    IdentityFile ~/.ssh/gerrit_admin</div></pre></td></tr></table></figure>
<h1 id="verify-your-alias-by-“ssh-lgadmin”"><a href="#verify-your-alias-by-“ssh-lgadmin”" class="headerlink" title="verify your alias by “ssh lgadmin”"></a>verify your alias by “ssh lgadmin”</h1><p>#通过gerrit登录数据库<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ ssh lgadmin gerrit gsql</div><div class="line">fatal: admin does not have <span class="string">"Access Database"</span> capability.</div></pre></td></tr></table></figure></p>
<h1 id="version-after-2-12-only-can-enable-this-through-webUI"><a href="#version-after-2-12-only-can-enable-this-through-webUI" class="headerlink" title="version after 2.12, only can enable this through webUI"></a>version after 2.12, only can enable this through webUI</h1><p>Project -&gt; All-Projects -&gt; Edit -&gt; Global Capabilities -&gt; add permission</p>
<h1 id="older-version-创建-修改-All-Projects的refs-meta-config-project-config"><a href="#older-version-创建-修改-All-Projects的refs-meta-config-project-config" class="headerlink" title="older version: 创建(修改)All-Projects的refs/meta/config/project.config"></a>older version: 创建(修改)All-Projects的refs/meta/config/project.config</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ vi /etc/gerrit/git/All-Projects/refs/meta/config/project.config</div><div class="line">[capability]</div><div class="line">       accessDatabase = group Administrators</div></pre></td></tr></table></figure>
<p>#查看可见的群组<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ssh -p 29418 admin@localhost gerrit ls-groups</div></pre></td></tr></table></figure></p>
<p>#创建新的项目,–owner需要的群组必须要在Gerrit已经定义好的<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ssh -p 29418 admin@localhost gerrit create-project <span class="string">"test/helloworld"</span> --description <span class="string">"'Tools used by build system'"</span> --owner <span class="string">"user/admin"</span> --parent <span class="string">"All-Projects"</span></div></pre></td></tr></table></figure></p>
<p>#修改项目配置<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ssh -p 29418 admin@localhost gerrit <span class="built_in">set</span>-project <span class="string">"repo_name"</span> --project-state ACTIVE --submit-type FAST_FORWARD_ONLY</div></pre></td></tr></table></figure></p>
<p>#设置继承项目<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ssh -p 29418 admin@localhost gerrit <span class="built_in">set</span>-project-parent <span class="string">"repo_name"</span> --parent <span class="string">"parent_repo"</span></div></pre></td></tr></table></figure></p>
<p>#自动审查打分<br><code>bash
$ ssh -p 29418 admin@localhost gerrit review {COMMITID | CHANGEID,PATCHSET} --verified +1 --code-review +1 --message &quot;review from ssh&quot;
$ cat ~/.ssh/user1.pub | ssh ha gerrit create-account --email user1@163.com --full-name 张三 --ssh-key</code> bash</p>
<h1 id="Gerrit默认的项目权限"><a href="#Gerrit默认的项目权限" class="headerlink" title="Gerrit默认的项目权限"></a>Gerrit默认的项目权限</h1><p>默认: 项目的master分支只有administrators和Project Owners可以不经代码审核直接推送,但允许其他用户向master分支推送changes接受评审.<br>期望: Registered Users组用户不能向master推送changes,而只能向devel分支推送changes。devel分支的权限默认即可。项目只有两个常设分支master和devel,日常开发只在devel分支上,只有管理员才能touch master分支.<br>修改设置: Project-&gt;list(选定项目)-&gt;Access-&gt;Edit-&gt;Add Reference, reference的名字为:refs/for/refs/heads/master,然后添加push权限,添加组”Registered Users”,选择对应的push权限为deny,同时勾选Exclusive，覆盖掉该ref继承和被通配符所涵盖的权限.</p>
<h1 id="Code-Review和submit"><a href="#Code-Review和submit" class="headerlink" title="Code Review和submit"></a>Code Review和submit</h1><p>默认: 只给Registered Users组用户Code View -1分到1分的权限,这样Registered Users组用户就无法独立完成代码审核, 而且该组用户没有submit的权限,无法合并补丁到仓库中.<br>期望: 因为developer都集中在Registered Users中,包括资深的developer,所以Code View权限需要提高.同时需要添加submit权限.<br>修改设置: Project-&gt;list(选定项目)-&gt;Access-&gt;Edit-&gt;Add Reference,reference的名字为:refs/heads/*,然后添加Label Code-Review,添加组”Registered Users”,将其权限调整为-2~2.然后对Submit权限添加组”Registered Users”并设为ALLOW.</p>
<h1 id="sandbox分支"><a href="#sandbox分支" class="headerlink" title="sandbox分支"></a>sandbox分支</h1><p>即个人分支,是十分有必要的,在开发成果还没有达到可以参加评审之前,用户可以在个人分支暂存自己的代码<br>修改设置: 添加引用refs/heads/sandbox/${username}/*,选择权限Create Reference和push,”Registered Users”组权限皆为ALLOW</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://192.168.1.3/2017/06/25/gerrit-tutor/" data-id="cj4e773fi0002okxtfn3xfeld" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-git-tutor" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/06/25/git-tutor/" class="article-date">
  <time datetime="2017-06-25T02:57:47.000Z" itemprop="datePublished">2017-06-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/06/25/git-tutor/">Git tutorial</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-gt-Overview"><a href="#1-gt-Overview" class="headerlink" title="1&gt; Overview"></a>1&gt; Overview</h2><p>‘git’ is a distribution system to maintain source codes. It’s veriy special and smart as “GIT TRACKS CHANGES RATHER THAN FILES”. It’s designed based on the following framework:<br>“working area” – git add –&gt; “stage buffer” – git commit –&gt; “local repo.branch” – git push –&gt; “remote repo.branch”</p>
<h2 id="2-gt-Install"><a href="#2-gt-Install" class="headerlink" title="2&gt; Install"></a>2&gt; Install</h2><p>approch1<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo apt-get install git</div></pre></td></tr></table></figure></p>
<p>approch2<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ <span class="comment"># download the source code package</span></div><div class="line">$ <span class="comment"># uncompress the source code package</span></div><div class="line">$ ./config</div><div class="line">$ make</div><div class="line">$ sudo make install</div></pre></td></tr></table></figure></p>
<h2 id="3-gt-Configure"><a href="#3-gt-Configure" class="headerlink" title="3&gt; Configure"></a>3&gt; Configure</h2><h3 id="3-1-gt-global-level-“-gitconfig”-is-the-config-file-for-current-user"><a href="#3-1-gt-global-level-“-gitconfig”-is-the-config-file-for-current-user" class="headerlink" title="3.1&gt; global-level: “~/.gitconfig” is the config file for current user"></a>3.1&gt; global-level: “~/.gitconfig” is the config file for current user</h3><p>way1: directly edit “~/.gitconfig”<br>way2: use the command “git config –global <item> “blabla…””<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ git config --global color.ui <span class="literal">true</span></div><div class="line">$ git config --global user.name <span class="string">"Your Name"</span></div><div class="line">$ git config --global user.email <span class="string">"email@example.com"</span></div></pre></td></tr></table></figure></item></p>
<p>Hightlight: frequently-used allas<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ git config --global alias.last <span class="string">'log -1'</span>	<span class="comment"># last = log -1	</span></div><div class="line">$ git config --global alias.st status		<span class="comment"># st   = status</span></div><div class="line">$ git config --global alias.co checkout		<span class="comment"># co   = checkout</span></div><div class="line">$ git config --global alias.ci commit		<span class="comment"># ci   = commit</span></div><div class="line">$ git config --global alias.br branch		<span class="comment"># br   = branch</span></div><div class="line">$ git config --global alias.unstage <span class="string">'reset HEAD'</span> <span class="comment"># unstage = reset HEAD</span></div><div class="line">$ git config --global alias.lg <span class="string">"log --color --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset' --abbrev-commit"</span></div></pre></td></tr></table></figure></p>
<h3 id="3-2-gt-project-level-“-…-git-config”-is-the-config-file-for-current-project"><a href="#3-2-gt-project-level-“-…-git-config”-is-the-config-file-for-current-project" class="headerlink" title="3.2&gt; project-level: “~/…//.git/config” is the config file for current project"></a>3.2&gt; project-level: “~/…/<project>/.git/config” is the config file for current project</project></h3><p>way1: directly edit “~/…/<project>/.git/config”<br>way2: use the command “git config <item> “blabla…””</item></project></p>
<h2 id="4-gt-Prepare-to-work-locally"><a href="#4-gt-Prepare-to-work-locally" class="headerlink" title="4&gt; Prepare to work locally"></a>4&gt; Prepare to work locally</h2><h3 id="4-1-gt-create-one-‘repository’"><a href="#4-1-gt-create-one-‘repository’" class="headerlink" title="4.1&gt; create one ‘repository’"></a>4.1&gt; create one ‘repository’</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ mkdir learngit</div><div class="line">$ <span class="built_in">cd</span> learngit</div><div class="line">$ git init</div></pre></td></tr></table></figure>
<h3 id="4-2-gt-filter-files-to-be-ignored"><a href="#4-2-gt-filter-files-to-be-ignored" class="headerlink" title="4.2&gt; filter files to be ignored"></a>4.2&gt; filter files to be ignored</h3><p>Then “.git” folder is created (to check with “ls -ah”) and all files in this directory will be managed by ‘git’ by default.<br>If you don’t want some special files to be treated as a part of this ‘repository’, please explicitly tell the ‘git’ by the file ‘.gitignore’, it can be edited like this way:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">echo</span> *.doc &gt;&gt; .gitignore</div></pre></td></tr></table></figure></p>
<p>When you cannot make sure whether a file is being managed by ‘git’ or not:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ git check-ignore -v &lt;filename&gt; <span class="comment"># to check the conflict</span></div></pre></td></tr></table></figure></p>
<h2 id="5-gt-Understand-the-operational-principle-“tracking-changes”"><a href="#5-gt-Understand-the-operational-principle-“tracking-changes”" class="headerlink" title="5&gt; Understand the operational principle “tracking changes”"></a>5&gt; Understand the operational principle “tracking changes”</h2><h3 id="5-1-gt-create-the-original-version"><a href="#5-1-gt-create-the-original-version" class="headerlink" title="5.1&gt; create the original version"></a>5.1&gt; create the original version</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">echo</span> baseline &gt; readme.txt</div><div class="line">$ git add readme.txt</div><div class="line">$ git commit -m <span class="string">"create a readme file"</span></div></pre></td></tr></table></figure>
<h3 id="5-2-gt-create-the-draft1-and-draft2-version"><a href="#5-2-gt-create-the-draft1-and-draft2-version" class="headerlink" title="5.2&gt; create the draft1 and draft2 version"></a>5.2&gt; create the draft1 and draft2 version</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">echo</span> draft1 &gt;&gt; readme.txt</div><div class="line">$ git status</div><div class="line">$ git add readme.txt</div><div class="line">$ git status</div><div class="line">$ <span class="built_in">echo</span> draft2 &gt;&gt; readme.txt</div><div class="line">$ git status</div><div class="line">$ git commit -m <span class="string">"draft1"</span></div><div class="line">$ git status</div><div class="line">$ git diff HEAD -- readme.txt <span class="comment"># compare "working" and "repo"</span></div><div class="line">$ git add readme.txt</div><div class="line">$ git status</div><div class="line">$ git commit -m <span class="string">"draft2"</span></div><div class="line">$ git status</div></pre></td></tr></table></figure>
<h3 id="5-3-gt-list-all-history-versions"><a href="#5-3-gt-list-all-history-versions" class="headerlink" title="5.3&gt; list all history versions"></a>5.3&gt; list all history versions</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ git <span class="built_in">log</span> --pretty=oneline</div></pre></td></tr></table></figure>
<h3 id="5-4-gt-revert-back-to-one-previous-version"><a href="#5-4-gt-revert-back-to-one-previous-version" class="headerlink" title="5.4&gt; revert/back to one previous version"></a>5.4&gt; revert/back to one previous version</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ git reset --hard HEAD^</div><div class="line">$ <span class="comment">#git reset --hard HEAD^^</span></div><div class="line">$ <span class="comment">#git reset --hard HEAD~100</span></div><div class="line">$ git <span class="built_in">log</span> --pretty=oneline</div><div class="line">$ git reflog <span class="comment">#-- operation history</span></div><div class="line">$ git reset --hard &lt;commit_id&gt;</div></pre></td></tr></table></figure>
<h3 id="5-5-gt-sync-“working-area”-per-“current-repo”"><a href="#5-5-gt-sync-“working-area”-per-“current-repo”" class="headerlink" title="5.5&gt; sync “working area” per “current repo”"></a>5.5&gt; sync “working area” per “current repo”</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">echo</span> stupid &gt;&gt; readme.txt</div><div class="line">$ git add readme.txt</div><div class="line">$ git checkout -- readme.txt</div><div class="line">$ git diff HEAD -- readme.txt</div><div class="line">$ git status</div></pre></td></tr></table></figure>
<h3 id="5-6-gt-unstage-sync-“stage-buffer”-per-“current-repo”"><a href="#5-6-gt-unstage-sync-“stage-buffer”-per-“current-repo”" class="headerlink" title="5.6&gt; unstage: sync “stage buffer” per “current repo”"></a>5.6&gt; unstage: sync “stage buffer” per “current repo”</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ git reset HEAD readme.txt</div><div class="line">$ git status</div></pre></td></tr></table></figure>
<h3 id="5-7-gt-delete-one-file"><a href="#5-7-gt-delete-one-file" class="headerlink" title="5.7&gt; delete one file"></a>5.7&gt; delete one file</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">$ touch test.c</div><div class="line">$ git status</div><div class="line">$ git add test.c</div><div class="line">$ git commit -m <span class="string">"add test.c"</span></div><div class="line">$ rm test.c</div><div class="line">$ git status</div><div class="line">$ git rm test.c</div><div class="line">$ git commit -m <span class="string">"remove test.c"</span></div></pre></td></tr></table></figure>
<h2 id="6-gt-Prepare-to-work-remotely-demo-with-GitHub-website"><a href="#6-gt-Prepare-to-work-remotely-demo-with-GitHub-website" class="headerlink" title="6&gt; Prepare to work remotely (demo with GitHub website)"></a>6&gt; Prepare to work remotely (demo with GitHub website)</h2><h3 id="6-1-gt-login-create-your-GitHub-account"><a href="#6-1-gt-login-create-your-GitHub-account" class="headerlink" title="6.1&gt; login/create your GitHub account."></a>6.1&gt; login/create your <a href="https://github.com/" target="_blank" rel="external">GitHub</a> account.</h3><h3 id="6-2-gt-create-your-ssh-rsa-id-with-your-email-used-in-GitHub"><a href="#6-2-gt-create-your-ssh-rsa-id-with-your-email-used-in-GitHub" class="headerlink" title="6.2&gt; create your ssh_rsa_id with your email used in GitHub."></a>6.2&gt; create your ssh_rsa_id with your email used in GitHub.</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ ssh-keygen -t rsa -C <span class="string">"youremail@example.com"</span></div><div class="line">$ cat ~/.ssh/id_rsa.pub</div></pre></td></tr></table></figure>
<p>copy the console output to be pasted in GitHub website.</p>
<h3 id="6-3-gt-let-your-GitHub-website-know-this-public-key"><a href="#6-3-gt-let-your-GitHub-website-know-this-public-key" class="headerlink" title="6.3&gt; let your GitHub website know this public key"></a>6.3&gt; let your <a href="https://github.com/" target="_blank" rel="external">GitHub</a> website know this public key</h3><p>“Settings”-&gt;”SSH and GPG keys”-&gt;”New SSH key”, paste in “Key”, click “Add SSH key” to finish.</p>
<h3 id="6-4-gt-create-the-first-repository-in-your-GitHub-website"><a href="#6-4-gt-create-the-first-repository-in-your-GitHub-website" class="headerlink" title="6.4&gt; create the first repository in your GitHub website"></a>6.4&gt; create the first repository in your <a href="https://github.com/" target="_blank" rel="external">GitHub</a> website</h3><p>“New repository”, fill “name/description/public”, click “Create”.</p>
<h3 id="6-5-gt-create-one-link-to-the-remote-repo"><a href="#6-5-gt-create-one-link-to-the-remote-repo" class="headerlink" title="6.5&gt; create one link to the remote repo"></a>6.5&gt; create one link to the remote repo</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">cd</span> ~/learngit</div><div class="line">$ git remote -v <span class="comment"># show info(link) about the remote repo</span></div><div class="line">$ git remote add origin git@github.com:&lt;account&gt;/learngit.git</div><div class="line">$ <span class="comment">#git remote add origin git@&lt;server-name&gt;:&lt;path&gt;/&lt;repo-name&gt;.git</span></div></pre></td></tr></table></figure>
<h3 id="6-6-gt-switch-to-another-remote-server"><a href="#6-6-gt-switch-to-another-remote-server" class="headerlink" title="6.6&gt; switch to another remote server"></a>6.6&gt; switch to another remote server</h3><p>“git remote -v” lists all flags which point to the remote git repository.<br>The following 1&gt; sync current branch with the previous remote repository; 2&gt; create a new flag pointing to a new repository; 3&gt; upload files and links (the local ‘master’ reference) to that new repository.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ git pull -r</div><div class="line">$ git remote <span class="built_in">set</span>-url lgerrit ssh://jacky@192.168.1.3:29418/iboot.git</div><div class="line">$ git push -u lgerrit master</div></pre></td></tr></table></figure></p>
<p>The following 1&gt; clone everything(including all branches and tags) from a remote repository; 2&gt; create a new flag pointing to another new repository; 3&gt; upload everything to that new repository.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ git <span class="built_in">clone</span> --mirror git@github.com:jacky168wang/iboot.git</div><div class="line">$ git remote <span class="built_in">set</span>-url origin ssh://admin@192.168.1.3:29418/iboot.git</div><div class="line">$ git push --mirror</div></pre></td></tr></table></figure></p>
<h2 id="7-gt-Understand-the-distributed-version-control-system"><a href="#7-gt-Understand-the-distributed-version-control-system" class="headerlink" title="7&gt; Understand the distributed version control system"></a>7&gt; Understand the distributed version control system</h2><h3 id="7-1-gt-upload-files-AND-link-local-‘master’-to-remote-‘master’"><a href="#7-1-gt-upload-files-AND-link-local-‘master’-to-remote-‘master’" class="headerlink" title="7.1&gt; upload files AND link local ‘master’ to remote ‘master’"></a>7.1&gt; upload files AND link local ‘master’ to remote ‘master’</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ git push -u origin master <span class="comment"># only 1st time need '-u'</span></div></pre></td></tr></table></figure>
<h3 id="7-2-gt-clone-the-repo-and-files-from-the-remote"><a href="#7-2-gt-clone-the-repo-and-files-from-the-remote" class="headerlink" title="7.2&gt; clone the repo (and files) from the remote"></a>7.2&gt; clone the repo (and files) from the remote</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">cd</span> ~</div><div class="line">$ git <span class="built_in">clone</span> git@github.com:&lt;account&gt;/learngit.git</div><div class="line">$ <span class="comment">#git clone git@&lt;server-name&gt;:&lt;path&gt;/&lt;repo-name&gt;.git</span></div></pre></td></tr></table></figure>
<h3 id="7-3-gt-create-a-new-branch-quickly"><a href="#7-3-gt-create-a-new-branch-quickly" class="headerlink" title="7.3&gt; create a new branch quickly"></a>7.3&gt; create a new branch quickly</h3><p>before branch : p_HEAD -&gt; p_master -&gt; “repo_chain”<br>after  branch : new p_dev -&gt; “repo_chain”, p_HEAD = p_dev<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ git checkout -b dev <span class="comment"># equal 'git branch dev' + 'git checkout dev'</span></div><div class="line">$ git branch <span class="comment"># list all branches</span></div></pre></td></tr></table></figure></p>
<p>branch advance: new one node per each ‘commit’, p_dev++<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">echo</span> BRANCH &gt;&gt; readme.txt</div><div class="line">$ git add readme.txt</div><div class="line">$ git commit -m <span class="string">"new branch"</span></div></pre></td></tr></table></figure></p>
<h3 id="7-4-gt-merge"><a href="#7-4-gt-merge" class="headerlink" title="7.4&gt; merge"></a>7.4&gt; merge</h3><p>Compare ‘end’ node of current branch with the other, if no conflict, p_master -&gt; the ‘end’ node of p_dev; else, new one node with your changes, p_master -&gt; it.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ git checkout master</div><div class="line">$ cat readme.txt</div><div class="line">$ git merge dev</div><div class="line">$ cat readme.txt <span class="comment"># if conflict, manually modify it, then git add &amp; commit</span></div></pre></td></tr></table></figure></p>
<h3 id="7-5-gt-picture-details-of-the-roadmap"><a href="#7-5-gt-picture-details-of-the-roadmap" class="headerlink" title="7.5&gt; picture details of the roadmap"></a>7.5&gt; picture details of the roadmap</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ git <span class="built_in">log</span> --graph --pretty=oneline --abbrev-commit</div></pre></td></tr></table></figure>
<h3 id="7-6-gt-remove-branch-delete-p-dev"><a href="#7-6-gt-remove-branch-delete-p-dev" class="headerlink" title="7.6&gt; remove branch: delete p_dev"></a>7.6&gt; remove branch: delete p_dev</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ git branch -d dev</div><div class="line">$ git branch</div></pre></td></tr></table></figure>
<h2 id="8-gt-Branches-in-generial-development-team"><a href="#8-gt-Branches-in-generial-development-team" class="headerlink" title="8&gt; Branches in generial development team"></a>8&gt; Branches in generial development team</h2><h3 id="8-1-gt-bug-branch-and-save-snapshot-‘working-area’"><a href="#8-1-gt-bug-branch-and-save-snapshot-‘working-area’" class="headerlink" title="8.1&gt; bug branch and save/snapshot ‘working area’"></a>8.1&gt; bug branch and save/snapshot ‘working area’</h3><p>One bug is reported in your last commit. you’re asked to fix it ASAP, but current ongoing change has not been finished.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ git stash</div></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ git checkout master</div><div class="line">$ git checkout -b bug238 <span class="comment"># new a branch working on to fix this bug</span></div><div class="line">Then <span class="keyword">do</span> changes and tests</div><div class="line">$ <span class="comment">#git add readme.txt</span></div><div class="line">$ <span class="comment">#git commit -m "get bug238 fixed"</span></div><div class="line">$ git checkout master</div><div class="line">$ git merge --no-ff -m <span class="string">"merged bug238 fix"</span> bug238</div></pre></td></tr></table></figure>
<p>Finally recover previous ongoing change and drop the buffer<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ git checkout dev</div><div class="line">$ git stash list <span class="comment"># show all buffered snapshots</span></div><div class="line">$ git stash pop <span class="comment"># recover previous ongoing change and drop the buffer</span></div><div class="line">$ <span class="comment">#git stash apply stash@&#123;&lt;index&gt;&#125; # pick-up one of snapshots</span></div></pre></td></tr></table></figure></p>
<h3 id="8-2-gt-abandon-one-trial-branch"><a href="#8-2-gt-abandon-one-trial-branch" class="headerlink" title="8.2&gt; abandon one trial branch"></a>8.2&gt; abandon one trial branch</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ git checkout -b trial</div><div class="line">$ touch trial.c</div><div class="line">$ git add trial.c</div><div class="line">$ git commit -m <span class="string">"new branch for trial"</span></div><div class="line">$ git checkout dev</div><div class="line">$ git branch -D trial <span class="comment"># removing un-merged branch with '-d' will fail</span></div></pre></td></tr></table></figure>
<h3 id="8-3-gt-co-work-in-a-team"><a href="#8-3-gt-co-work-in-a-team" class="headerlink" title="8.3&gt;  co-work in a team"></a>8.3&gt;  co-work in a team</h3><p>  remote_b_master:           m1 ——– m2 —- m3<br>                 :           |           |       |<br> remote_b_develop: d1 —— d2 — d3 - d4 —- d5 — d6<br>                 :  |\       /|     /    /|       |<br>   user_b_develop:  | u1 - u2 / – u3 - u4| u5 u6 | u7 – u8<br>                 :   \       /            /       /<br> worker_b_develop:    w1 w2 w3 w4 - w5 - w6 w7 - w8 - w9 - w10</p>
<h3 id="8-4-gt-working-flow"><a href="#8-4-gt-working-flow" class="headerlink" title="8.4&gt; working flow"></a>8.4&gt; working flow</h3><p>  try “git push origin branch-name” push your changes;<br>  if fail(remote_branch newer than your)<br>  try to merge with “git pull”;<br>  if “no tracking info”<br>    “git branch –set-upstream branch-name origin/branch-name”;<br>    if conflict<br>      resolve then commit (locally);<br>    if no conflict or after resolved<br>      do “git push origin branch-name” again;</p>
<h2 id="9-gt-Tag-to-flag-the-significant-version"><a href="#9-gt-Tag-to-flag-the-significant-version" class="headerlink" title="9&gt; Tag to flag the significant version"></a>9&gt; Tag to flag the significant version</h2><p>‘tag’ means a snapshot for the repo at one moment. It use a readable name to flag/point-to one ‘commit’. It cannot move so different from ‘branch’.</p>
<h3 id="9-1-gt-create-one-local-tag"><a href="#9-1-gt-create-one-local-tag" class="headerlink" title="9.1&gt; create one (local) tag"></a>9.1&gt; create one (local) tag</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ git tag v1.0 <span class="comment"># current reference/master</span></div><div class="line">$ git <span class="built_in">log</span> --pretty=oneline --abbrev-commit</div><div class="line">$ git tag v0.9 &lt;commit_id&gt;</div><div class="line">$ git tag -a v0.1 -m <span class="string">"version 0.1 released"</span> &lt;commit_id&gt;</div></pre></td></tr></table></figure>
<h3 id="9-2-gt-create-one-local-tag-with-anti-fogery-signed-by-PGP-private-key"><a href="#9-2-gt-create-one-local-tag-with-anti-fogery-signed-by-PGP-private-key" class="headerlink" title="9.2&gt; create one (local) tag with anti-fogery signed by PGP private key"></a>9.2&gt; create one (local) tag with anti-fogery signed by PGP private key</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ git tag -s v0.2 -m <span class="string">"signed version 0.2 released"</span> &lt;commit_id&gt;</div></pre></td></tr></table></figure>
<h3 id="9-3-gt-upload-one-local-tag-to-the-remote"><a href="#9-3-gt-upload-one-local-tag-to-the-remote" class="headerlink" title="9.3&gt; upload one (local) tag to the remote"></a>9.3&gt; upload one (local) tag to the remote</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ git push origin &lt;tagname&gt;</div><div class="line">$ git push origin --tags</div></pre></td></tr></table></figure>
<h3 id="9-3-gt-show-check-show-details-about-one-local-tag"><a href="#9-3-gt-show-check-show-details-about-one-local-tag" class="headerlink" title="9.3&gt; show/check show details about one (local) tag"></a>9.3&gt; show/check show details about one (local) tag</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ git tag</div><div class="line">$ git show &lt;tagname&gt;</div></pre></td></tr></table></figure>
<h3 id="9-4-gt-delete-one-tag-and-sync-with-the-remote"><a href="#9-4-gt-delete-one-tag-and-sync-with-the-remote" class="headerlink" title="9.4&gt; delete one tag and sync with the remote"></a>9.4&gt; delete one tag and sync with the remote</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ git tag -d &lt;tagname&gt;</div><div class="line">$ git push origin :refs/tags/&lt;tagname&gt;</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://192.168.1.3/2017/06/25/git-tutor/" data-id="cj4e773fr0003okxtwtb0fdi2" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/06/25/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2017/06/25/linux-daemon/">linux-daemon</a>
          </li>
        
          <li>
            <a href="/2017/06/25/gerrit-mngt/">Gerrit mangement</a>
          </li>
        
          <li>
            <a href="/2017/06/25/gerrit-tutor/">Gerrit tutorial</a>
          </li>
        
          <li>
            <a href="/2017/06/25/git-tutor/">Git tutorial</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 JackyWang<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>